{"version":3,"file":"common.js","mappings":";;;;;;;;;;;;;;;;;AAAA;AACA;AAAA;AAIA;AAAA;AACA;AACA;;AAEA;AACA;AAEA;AACA;AAAA;AAEA;AACA;AAAA;AAAA;AAAA;AAGA;AAAA;AAGA;AAAA;AAGA;AACA;AAAA;AAAA;AAAA;AAGA;AAAA;AAGA;AAAA;AAGA;AACA;AAAA;AAAA;AAAA;AAGA;AAAA;AAGA;AAAA;AAGA;AACA;AAAA;AAAA;AAAA;AAGA;AAAA;AAGA;AAAA;AACA;AAGA;;;;;;;;;;;;;;;;;;;;ACxDA;AACA;AACA;AAAA;AAIA;AAAA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAAA;AAEA;AACA;AAAA;AAEA;AAAA;AAEA;AACA;AAAA;AAGA;AAAA;AACA;AAGA;;;;;;;;;;;;;;;;;;;;AC7BA;AACA;AACA;AAAA;AAYA;AAQA;AAPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAAA;AAEA;AAAA;AAEA;AAAA;AACA;AAAA;AAAA;AAAA;AAKA;AAGA;AACA;AACA;AACA;AACA;AAAA;AACA;AAIA;AAAA;AAEA;AAAA;AACA;AAIA;AAAA;AACA;AAIA;AAAA;AAAA;AAEA;AAAA;AAEA;AACA;AACA;AACA;AAAA;AAGA;AACA;AAAA;AAGA;AAAA;AACA;AACA;AACA;AAGA;;;;;;;;;;;;;;;;;;;ACrJA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA","sources":["webpack://myApp/._src_components_Footer.tsx","webpack://myApp/._src_components_Header.tsx","webpack://myApp/._src_components_ProductBlock.tsx","webpack://myApp/._src_utils_auth.ts"],"sourcesContent":["import { View, Text } from \"@tarojs/components\";\r\nimport Taro from \"@tarojs/taro\";\r\n\r\ntype Props = {};\r\n\r\nexport default function Footer({}: Props) {\r\n  // 获取当前页面路径\r\n  const currentPath = Taro.getCurrentInstance().router?.path || \"\";\r\n\r\n  // 判断是否为当前页面的函数\r\n  const isActive = (path: string) => currentPath.includes(path);\r\n\r\n  return (\r\n    <View className=\"fixed bottom-0 left-0 right-0 flex justify-between items-center bg-white py-2 border-t border-gray-200 h-[5%]\">\r\n      <View\r\n        className=\"flex-1 flex flex-col items-center\"\r\n        onClick={() => Taro.switchTab({ url: \"/pages/home/index\" })}\r\n      >\r\n        <Text\r\n          className={`text-2xl ${isActive(\"home\") ? \"text-[#fbb713]\" : \"\"}`}\r\n        >\r\n          🏠\r\n        </Text>\r\n      </View>\r\n      <View\r\n        className=\"flex-1 flex flex-col items-center\"\r\n        onClick={() => Taro.switchTab({ url: \"/pages/classify/index\" })}\r\n      >\r\n        <Text\r\n          className={`text-2xl ${isActive(\"classify\") ? \"text-[#fbb713]\" : \"\"}`}\r\n        >\r\n          🗂️\r\n        </Text>\r\n      </View>\r\n      <View\r\n        className=\"flex-1 flex flex-col items-center\"\r\n        onClick={() => Taro.switchTab({ url: \"/pages/cart/index\" })}\r\n      >\r\n        <Text\r\n          className={`text-2xl ${isActive(\"cart\") ? \"text-[#fbb713]\" : \"\"}`}\r\n        >\r\n          🛒\r\n        </Text>\r\n      </View>\r\n      <View\r\n        className=\"flex-1 flex flex-col items-center\"\r\n        onClick={() => Taro.switchTab({ url: \"/pages/person/index\" })}\r\n      >\r\n        <Text\r\n          className={`text-2xl ${isActive(\"person\") ? \"text-[#fbb713]\" : \"\"}`}\r\n        >\r\n          👤\r\n        </Text>\r\n      </View>\r\n    </View>\r\n  );\r\n}\r\n","import { View, Text, Image, Input } from \"@tarojs/components\";\r\nimport Taro from \"@tarojs/taro\";\r\nimport React from \"react\";\r\n\r\ntype Props = {};\r\n\r\nexport default function Header({}: Props) {\r\n  const handleInputClick = () => {\r\n    Taro.navigateTo({\r\n      url: \"/pages/search/index\",\r\n    });\r\n  };\r\n\r\n  return (\r\n    <View className=\"flex items-center justify-between bg-white border-b border-gray-200 fixed top-[3%] left-0 right-0\">\r\n      <Image\r\n        src=\"https://github.com/sh200122/SHBS/blob/main/front/public/images/logo.png?raw=true\"\r\n        className=\"w-20 h-20\"\r\n      />\r\n      <View className=\"flex items-center justify-center w-[55%] mr-28\">\r\n        <View\r\n          className=\"w-full border-solid border-[1px] p-2 border-gray-300 rounded bg-gray-50 text-gray-400\"\r\n          onClick={handleInputClick}\r\n        >\r\n          🔍 搜索商品\r\n        </View>\r\n      </View>\r\n    </View>\r\n  );\r\n}\r\n","import { View, Text, Image } from \"@tarojs/components\";\r\nimport Taro from \"@tarojs/taro\";\r\nimport { useState } from \"react\";\r\n\r\ninterface ProductProps {\r\n  id: string;\r\n  image: string;\r\n  name: string;\r\n  price: number;\r\n  description: string;\r\n  onClick?: () => void;\r\n  adminId: string;\r\n}\r\n\r\nexport default function ProductBlock({\r\n  id,\r\n  image,\r\n  name,\r\n  price,\r\n  description,\r\n  onClick,\r\n  adminId,\r\n}: ProductProps) {\r\n  const [loading, setLoading] = useState(true);\r\n  const [imageError, setImageError] = useState(false);\r\n  const defaultImage = \"/assets/images/default.png\";\r\n\r\n  const handleImageLoad = () => {\r\n    setLoading(false);\r\n  };\r\n\r\n  const handleImageError = () => {\r\n    setImageError(true);\r\n    setLoading(false);\r\n  };\r\n\r\n  const handleAddToCart = async (e: React.MouseEvent) => {\r\n    e.stopPropagation();\r\n\r\n    // 检查登录状态\r\n    const token = Taro.getStorageSync(\"token\");\r\n    if (!token) {\r\n      Taro.showToast({\r\n        title: \"请先登录\",\r\n        icon: \"error\",\r\n        duration: 2000,\r\n      });\r\n      return;\r\n    }\r\n\r\n    // 检查商品ID\r\n    if (!id) {\r\n      console.error(\"Product ID is missing\");\r\n      Taro.showToast({\r\n        title: \"商品信息错误\",\r\n        icon: \"error\",\r\n        duration: 2000,\r\n      });\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const response = await Taro.request({\r\n        url: \"http://localhost:5000/api/cart/add\",\r\n        method: \"POST\",\r\n        data: {\r\n          productId: id,\r\n          adminId,\r\n        },\r\n        header: {\r\n          Authorization: `Bearer ${token}`,\r\n        },\r\n      });\r\n\r\n      if (response.statusCode === 200) {\r\n        Taro.showToast({\r\n          title: \"已添加到购物车\",\r\n          icon: \"success\",\r\n          duration: 2000,\r\n        });\r\n        console.log(\"购物车更新成功:\", response.data);\r\n      } else {\r\n        throw new Error(response.data.message || \"添加失败\");\r\n      }\r\n    } catch (error: any) {\r\n      console.error(\"添加购物车错误:\", error);\r\n      Taro.showToast({\r\n        title: error.message || \"添加失败\",\r\n        icon: \"error\",\r\n        duration: 2000,\r\n      });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <View className=\"bg-white rounded-lg shadow-md overflow-hidden transform transition-transform duration-200 active:scale-95\">\r\n      {/* 商品图片 */}\r\n      <View className=\"relative w-full h-32\">\r\n        {loading && (\r\n          <View className=\"absolute inset-0 bg-gray-100 animate-pulse flex items-center justify-center\">\r\n            <Text className=\"text-gray-400\">加载中...</Text>\r\n          </View>\r\n        )}\r\n\r\n        <Image\r\n          className={`w-full h-full object-cover transition-opacity duration-300 ${\r\n            loading ? \"opacity-0\" : \"opacity-100\"\r\n          }`}\r\n          src={imageError ? defaultImage : image}\r\n          mode=\"aspectFill\"\r\n          onLoad={handleImageLoad}\r\n          onError={handleImageError}\r\n          lazyLoad\r\n        />\r\n      </View>\r\n\r\n      {/* 商品信息 */}\r\n      <View className=\"p-2 flex flex-col relative\">\r\n        {/* 商品名称 */}\r\n        <Text className=\"text-sm font-medium text-gray-800 truncate\">\r\n          {name}\r\n        </Text>\r\n\r\n        {/* 商品描述 */}\r\n        <Text className=\"text-xs text-gray-500 truncate mt-1\">\r\n          {description}\r\n        </Text>\r\n\r\n        {/* 价格 */}\r\n        <Text className=\"text-red-500 text-lg font-bold mt-1\">¥{price}</Text>\r\n\r\n        <View className=\"absolute bottom-3 right-2 flex gap-2\">\r\n          <View\r\n            className=\"rounded-lg transition-colors duration-200\"\r\n            hover-class=\"bg-red-500\"\r\n            hover-stay-time={100}\r\n            onClick={handleAddToCart}\r\n          >\r\n            <Text\r\n              className=\"text-2xl text-center transition-transform duration-200\"\r\n              hover-class=\"scale-110\"\r\n            >\r\n              🛒\r\n            </Text>\r\n          </View>\r\n        </View>\r\n      </View>\r\n    </View>\r\n  );\r\n}\r\n","import Taro from \"@tarojs/taro\";\r\n\r\nexport const setToken = (token: string) => {\r\n  Taro.setStorageSync(\"token\", token);\r\n};\r\n\r\nexport const getToken = () => {\r\n  return Taro.getStorageSync(\"token\");\r\n};\r\n\r\nexport const removeToken = () => {\r\n  Taro.removeStorageSync(\"token\");\r\n};\r\n\r\nexport const getUserId = () => {\r\n  return Taro.getStorageSync(\"userId\");\r\n};\r\n\r\nexport const setUserId = (userId: string) => {\r\n  Taro.setStorageSync(\"userId\", userId);\r\n};\r\n\r\nexport const removeUserId = () => {\r\n  Taro.removeStorageSync(\"userId\");\r\n};\r\n\r\nexport const logout = () => {\r\n  removeToken();\r\n  removeUserId();\r\n  Taro.removeStorageSync(\"searchHistory\"); // 清空搜索历史记录\r\n};\r\n"],"names":[],"sourceRoot":""}