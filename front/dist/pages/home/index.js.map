{"version":3,"file":"pages/home/index.js","mappings":";;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AClLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sources":["webpack://myApp/./src/pages/home/index.tsx?e54e","webpack://myApp/._src_pages_home_index.tsx"],"sourcesContent":["import { View, Text, ScrollView, Swiper, SwiperItem, Image } from \"@tarojs/components\";\nimport Header from \"@/components/Header\";\nimport Footer from \"@/components/Footer\";\nimport { useEffect, useState } from \"react\";\nimport Taro from \"@tarojs/taro\";\nimport ProductBlock from \"@/components/ProductBlock\";\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nexport default function Dashboard() {\n  const [bannerList] = useState([{\n    id: 1,\n    image: \"https://github.com/sh200122/SHBS/blob/main/front/public/images/banner1.jpg?raw=true\"\n  }, {\n    id: 2,\n    image: \"https://github.com/sh200122/SHBS/blob/main/front/public/images/banner1.jpg?raw=true\"\n  }, {\n    id: 3,\n    image: \"https://github.com/sh200122/SHBS/blob/main/front/public/images/banner1.jpg?raw=true\"\n  }]);\n  const [products, setProducts] = useState([]);\n  const [limitTimeProducts, setLimitTimeProducts] = useState([]);\n  const [hotSaleProducts, setHotSaleProducts] = useState([]);\n  const [recommendProducts, setRecommendProducts] = useState([]);\n\n  // 添加登录检查\n  useEffect(() => {\n    const checkLogin = () => {\n      try {\n        const userInfo = Taro.getStorageSync(\"user\");\n        if (!userInfo) {\n          // 未登录，跳转到登录页\n          Taro.redirectTo({\n            url: \"/pages/login/index\"\n          });\n        }\n      } catch (error) {\n        console.error(\"检查登录状态失败:\", error);\n        Taro.redirectTo({\n          url: \"/pages/login/index\"\n        });\n      }\n    };\n    checkLogin();\n  }, []);\n\n  // 随机打乱数组的函数\n  const shuffleArray = array => {\n    const newArray = [...array];\n    for (let i = newArray.length - 1; i > 0; i--) {\n      const j = Math.floor(Math.random() * (i + 1));\n      [newArray[i], newArray[j]] = [newArray[j], newArray[i]];\n    }\n    return newArray;\n  };\n\n  // 获取商品数据\n  useEffect(() => {\n    const fetchProducts = async () => {\n      try {\n        const response = await Taro.request({\n          url: \"http://localhost:5000/api/product\",\n          method: \"GET\"\n        });\n\n        // 只过滤 status 为 active 的商品\n        const activeProducts = response.data.filter(product => product.status === \"active\");\n\n        // 随机打乱并分配到不同区块\n        const shuffled = shuffleArray(activeProducts);\n        setProducts(activeProducts);\n        setLimitTimeProducts(shuffled.slice(0, 4));\n        setHotSaleProducts(shuffled.slice(4, 8));\n        setRecommendProducts(shuffled.slice(8, 12));\n      } catch (error) {\n        console.error(\"获取商品失败:\", error);\n      }\n    };\n    fetchProducts();\n  }, []);\n  return /*#__PURE__*/_jsxs(View, {\n    className: \"min-h-screen\",\n    children: [/*#__PURE__*/_jsx(Header, {}), /*#__PURE__*/_jsxs(ScrollView, {\n      className: \"fixed top-[11%] h-[84%] bg-gray-100 overflow-y-scroll w-full\",\n      scrollY: true,\n      enableFlex: true,\n      children: [/*#__PURE__*/_jsx(View, {\n        className: \"bg-sky-500 h-[30%]\",\n        children: /*#__PURE__*/_jsx(Swiper, {\n          className: \"h-full w-full\",\n          indicatorDots: true,\n          autoplay: true,\n          interval: 3000,\n          circular: true,\n          children: bannerList.map(banner => /*#__PURE__*/_jsx(SwiperItem, {\n            children: /*#__PURE__*/_jsx(Image, {\n              className: \"w-full h-full\",\n              src: banner.image,\n              mode: \"aspectFill\"\n            })\n          }, banner.id))\n        })\n      }), /*#__PURE__*/_jsxs(View, {\n        className: \"h-[70%]\",\n        children: [/*#__PURE__*/_jsxs(View, {\n          className: \"flex p-4 justify-between items-center h-[10%] bg-white\",\n          children: [/*#__PURE__*/_jsx(Text, {\n            className: \"text-2xl font-bold\",\n            children: \"\\u231B\\u9650\\u65F6\\u6361\\u6F0F\"\n          }), /*#__PURE__*/_jsx(Text, {\n            className: \"text-sm text-gray-500\",\n            children: \"\\u67E5\\u770B\\u66F4\\u591A\"\n          })]\n        }), /*#__PURE__*/_jsx(View, {\n          className: \"h-[90%] p-2\",\n          children: /*#__PURE__*/_jsx(View, {\n            className: \"grid grid-cols-2 gap-2 h-full\",\n            children: limitTimeProducts.map(product => /*#__PURE__*/_jsx(ProductBlock, {\n              id: product._id,\n              image: product.image,\n              name: product.name,\n              price: product.price,\n              description: product.description,\n              onClick: () => {}\n            }, product._id))\n          })\n        })]\n      }), /*#__PURE__*/_jsxs(View, {\n        className: \"h-[70%]\",\n        children: [/*#__PURE__*/_jsxs(View, {\n          className: \"flex p-4 justify-between items-center h-[10%] bg-white\",\n          children: [/*#__PURE__*/_jsx(Text, {\n            className: \"text-2xl font-bold\",\n            children: \"\\uD83D\\uDD25\\u70ED\\u5356\\u4E8C\\u624B\"\n          }), /*#__PURE__*/_jsx(Text, {\n            className: \"text-sm text-gray-500\",\n            children: \"\\u67E5\\u770B\\u66F4\\u591A\"\n          })]\n        }), /*#__PURE__*/_jsx(View, {\n          className: \"h-[90%] p-2\",\n          children: /*#__PURE__*/_jsx(View, {\n            className: \"grid grid-cols-2 gap-2 h-full\",\n            children: hotSaleProducts.map(product => /*#__PURE__*/_jsx(ProductBlock, {\n              id: product._id,\n              image: product.image,\n              name: product.name,\n              price: product.price,\n              description: product.description,\n              onClick: () => {}\n            }, product._id))\n          })\n        })]\n      }), /*#__PURE__*/_jsxs(View, {\n        className: \"h-[70%]\",\n        children: [/*#__PURE__*/_jsxs(View, {\n          className: \"flex p-4 justify-between items-center h-[10%] bg-white\",\n          children: [/*#__PURE__*/_jsx(Text, {\n            className: \"text-2xl font-bold\",\n            children: \"\\uD83D\\uDC40\\u731C\\u4F60\\u559C\\u6B22\"\n          }), /*#__PURE__*/_jsx(Text, {\n            className: \"text-sm text-gray-500\",\n            children: \"\\u67E5\\u770B\\u66F4\\u591A\"\n          })]\n        }), /*#__PURE__*/_jsx(View, {\n          className: \"h-[90%] p-2\",\n          children: /*#__PURE__*/_jsx(View, {\n            className: \"grid grid-cols-2 gap-2 h-full\",\n            children: recommendProducts.map(product => /*#__PURE__*/_jsx(ProductBlock, {\n              id: product._id,\n              image: product.image,\n              name: product.name,\n              price: product.price,\n              description: product.description,\n              onClick: () => {}\n            }, product._id))\n          })\n        })]\n      })]\n    }), /*#__PURE__*/_jsx(Footer, {})]\n  });\n}","import { createPageConfig } from '@tarojs/runtime'\nimport component from \"!!../../../node_modules/@tarojs/taro-loader/lib/entry-cache.js?name=pages/home/index!./index.tsx\"\nvar config = {};\n\n\n\nvar taroOption = createPageConfig(component, 'pages/home/index', {root:{cn:[]}}, config || {})\nif (component && component.behaviors) {\n  taroOption.behaviors = (taroOption.behaviors || []).concat(component.behaviors)\n}\nvar inst = Page(taroOption)\n\n\n\nexport default component\n"],"names":[],"sourceRoot":""}