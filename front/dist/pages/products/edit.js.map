{"version":3,"file":"pages/products/edit.js","mappings":";;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACnKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sources":["webpack://myApp/./src/pages/products/edit.tsx?18a6","webpack://myApp/._src_pages_products_edit.tsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { Button, Input, Text, Label, Textarea, Form, View, Image } from \"@tarojs/components\";\nimport Taro from \"@tarojs/taro\";\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nexport default function edit(_ref) {\n  let {} = _ref;\n  const [name, setName] = useState(\"\");\n  const [price, setPrice] = useState(\"\");\n  const [description, setDescription] = useState(\"\");\n  const [image, setImage] = useState(\"\");\n  useEffect(() => {\n    const adminInfo = Taro.getStorageSync('adminInfo');\n    const id = Taro.getCurrentInstance().router?.params?.id;\n    Taro.request({\n      url: `http://localhost:5000/api/product/${id}`,\n      method: \"GET\",\n      header: {\n        'admin-id': adminInfo._id\n      },\n      success: res => {\n        const product = res.data;\n        setName(product.name);\n        setPrice(product.price);\n        setDescription(product.description);\n        setImage(product.image);\n      },\n      fail: err => {\n        console.log(err);\n        Taro.showToast({\n          title: \"获取商品失败\",\n          icon: \"none\"\n        });\n      }\n    });\n  }, []);\n  const handleSubmit = async e => {\n    e.preventDefault();\n    const adminInfo = Taro.getStorageSync('adminInfo');\n    const id = Taro.getCurrentInstance().router?.params?.id;\n    Taro.request({\n      url: `http://localhost:5000/api/product/${id}`,\n      method: \"PUT\",\n      header: {\n        'admin-id': adminInfo._id\n      },\n      data: {\n        name,\n        price: Number(price),\n        description,\n        image\n      },\n      success: () => {\n        Taro.showToast({\n          title: \"编辑商品成功\",\n          icon: \"success\"\n        });\n        setTimeout(() => {\n          Taro.reLaunch({\n            url: \"/pages/products/index\"\n          });\n        }, 1500);\n      },\n      fail: err => {\n        console.log(err);\n        Taro.showToast({\n          title: \"编辑商品失败，请重试\",\n          icon: \"none\"\n        });\n      }\n    });\n  };\n  const handleChooseImage = async () => {\n    try {\n      const res = await Taro.chooseImage({\n        count: 1,\n        sizeType: [\"compressed\"],\n        sourceType: [\"album\", \"camera\"]\n      });\n\n      // 将图片转换为Base64\n      const tempFilePath = res.tempFilePaths[0];\n      const fileContent = await Taro.getFileSystemManager().readFileSync(tempFilePath, \"base64\");\n      const base64Image = `data:image/jpeg;base64,${fileContent}`;\n      setImage(base64Image);\n      Taro.showToast({\n        title: \"图片选择成功\",\n        icon: \"success\"\n      });\n    } catch (error) {\n      console.error(\"图片处理失败:\", error);\n      Taro.showToast({\n        title: \"图片处理失败\",\n        icon: \"none\"\n      });\n    }\n  };\n  const handleCancel = () => {\n    Taro.reLaunch({\n      url: \"/pages/products/index\"\n    });\n  };\n  return /*#__PURE__*/_jsx(\"view\", {\n    className: \"w-screen h-screen bg-[#e8e8e8] flex items-center justify-center p-4\",\n    children: /*#__PURE__*/_jsxs(Form, {\n      onSubmit: handleSubmit,\n      className: \"w-full max-w-lg h-auto bg-white rounded-lg shadow-lg p-6 space-y-4\",\n      children: [/*#__PURE__*/_jsx(Text, {\n        className: \"text-2xl font-bold block text-center mb-6\",\n        children: \"\\u7F16\\u8F91\\u5546\\u54C1\"\n      }), /*#__PURE__*/_jsx(Label, {\n        className: \"block text-gray-700 text-sm font-bold\",\n        children: \"\\u56FE\\u7247:\"\n      }), /*#__PURE__*/_jsxs(View, {\n        className: \"w-full flex items-center justify-center space-x-2\",\n        children: [/*#__PURE__*/_jsx(Image, {\n          src: image,\n          className: \"w-full h-full max-w-[300px] max-h-[300px] object-contain rounded\",\n          mode: \"widthFix\"\n        }), /*#__PURE__*/_jsx(Button, {\n          className: \"bg-[#fbb713] text-white h-6 w-30 rounded text-xs leading-6\",\n          hoverClass: \"bg-[#a3770c]\",\n          onClick: handleChooseImage,\n          children: \"\\u91CD\\u65B0\\u9009\\u62E9\\u56FE\\u7247\"\n        })]\n      }), /*#__PURE__*/_jsx(Label, {\n        className: \"block text-gray-700 text-sm font-bold mt-1\",\n        children: \"\\u5546\\u54C1:\"\n      }), /*#__PURE__*/_jsx(Input, {\n        name: \"name\",\n        type: \"text\",\n        value: name,\n        onInput: e => setName(e.detail.value),\n        className: \"w-full h-[50px] border-solid border-[1px] p-2 border-gray-300 rounded\"\n      }), /*#__PURE__*/_jsx(Label, {\n        className: \"block text-gray-700 text-sm font-bold mt-1\",\n        children: \"\\u4EF7\\u683C:\"\n      }), /*#__PURE__*/_jsx(Input, {\n        name: \"price\",\n        type: \"number\",\n        value: price,\n        onInput: e => setPrice(e.detail.value),\n        className: \"w-full h-[50px] border-solid border-[1px] p-2 border-gray-300 rounded\"\n      }), /*#__PURE__*/_jsx(Label, {\n        className: \"block text-gray-700 text-sm font-bold mt-1\",\n        children: \"\\u63CF\\u8FF0:\"\n      }), /*#__PURE__*/_jsx(Textarea, {\n        name: \"description\",\n        value: description,\n        onInput: e => setDescription(e.detail.value),\n        className: \"w-full h-[100px] border-solid border-[1px] p-2 border-gray-300 rounded\"\n      }), /*#__PURE__*/_jsx(Button, {\n        className: \"w-full bg-[#fbb713] text-white h-12 rounded mt-6\",\n        hoverClass: \"bg-[#a3770c]\",\n        formType: \"submit\",\n        children: \"\\u4FDD\\u5B58\"\n      }), /*#__PURE__*/_jsx(Button, {\n        className: \"w-full bg-red-500 text-white h-12 rounded mt-4\",\n        hoverClass: \"bg-red-600\",\n        onClick: handleCancel,\n        children: \"\\u53D6\\u6D88\"\n      })]\n    })\n  });\n}","import { createPageConfig } from '@tarojs/runtime'\nimport component from \"!!../../../node_modules/@tarojs/taro-loader/lib/entry-cache.js?name=pages/products/edit!./edit.tsx\"\nvar config = {};\n\n\n\nvar taroOption = createPageConfig(component, 'pages/products/edit', {root:{cn:[]}}, config || {})\nif (component && component.behaviors) {\n  taroOption.behaviors = (taroOption.behaviors || []).concat(component.behaviors)\n}\nvar inst = Page(taroOption)\n\n\n\nexport default component\n"],"names":[],"sourceRoot":""}