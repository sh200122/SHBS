{"version":3,"file":"HosMapContext.js","sources":["../../../../../src/api/apis/media/map/HosMapContext.ts"],"sourcesContent":["import Taro from '@tarojs/api'\nimport { shouldBeObject } from 'src/api/apis/utils'\nimport { MethodHandler } from 'src/api/apis/utils/handler'\n\nimport { temporarilyNotSupport } from '../../utils'\n\nexport class HosMapContext implements Taro.MapContext {\n  private nativeMapContextId: string\n\n  constructor (mapId: string) {\n    // @ts-ignore 若原生侧创建MapContext成功，则返回mapId字符串，否则返回undefined。\n    this.nativeMapContextId = window.JSBridge && window.JSBridge.createMapContext(mapId)\n  }\n\n  getCenterLocation (option?: Taro.MapContext.GetCenterLocationOption): Promise<Taro.MapContext.GetCenterLocationSuccessCallbackResult> {\n    return new Promise((resolve, reject) => {\n      const name = 'getCenterLocation'\n      const isValid = shouldBeObject(option).flag || typeof option === 'undefined'\n      if (!isValid) {\n        const res = { errMsg: `${name}:fail invalid params` }\n        return reject(res)\n      }\n      const { success, fail, complete } = option || {}\n      const handle = new MethodHandler({ name, success, fail, complete })\n      if (this.nativeMapContextId === 'undefined') {\n        const res = { errMsg: `${name}:fail native map controller was not found` }\n        reject(res)\n      } else {\n        // @ts-ignore\n        const result = window.JSBridge && window.JSBridge.callMapContextFunction(null,\n          { instanceId: this.nativeMapContextId, callType: 'get', funcName: 'getCenterLocation' })\n        if (typeof result === 'string') {\n          handle.fail(JSON.parse(result), { resolve, reject })\n        } else {\n          handle.success(result, { resolve, reject })\n        }\n      }\n    })\n  }\n\n  setLocMarkerIcon = temporarilyNotSupport('setLocMarkerIcon')\n\n  moveToLocation (option: Taro.MapContext.MoveToLocationOption): Promise<TaroGeneral.CallbackResult> {\n    return new Promise((resolve, reject) => {\n      const name = 'moveToLocation'\n      const isValid = shouldBeObject(option).flag\n      if (!isValid) {\n        const res = { errMsg: `${name}:fail invalid params` }\n        return reject(res)\n      }\n      const { success, fail, complete, latitude, longitude } = option\n      const handle = new MethodHandler({ name, success, fail, complete })\n      if (this.nativeMapContextId === 'undefined') {\n        const res = { errMsg: `${name}:fail native map controller was not found` }\n        reject(res)\n      } else {\n        // @ts-ignore\n        const result = window.JSBridge && window.JSBridge.callMapContextFunction({ latitude, longitude },\n          { instanceId: this.nativeMapContextId, callType: 'get', funcName: 'moveToLocation' })\n        if (typeof result === 'string') {\n          handle.fail(JSON.parse(result), { resolve, reject })\n        } else {\n          handle.success({ errMsg: `${name}:ok` }, { resolve, reject })\n        }\n      }\n    })\n  }\n\n  translateMarker = temporarilyNotSupport('translateMarker')\n\n  moveAlong = temporarilyNotSupport('moveAlong')\n\n  includePoints = temporarilyNotSupport('includePoints')\n\n  getRegion (_option?: Taro.MapContext.GetRegionOption): Promise<Taro.MapContext.GetRegionSuccessCallbackResult> {\n    return Promise.reject(new Error('暂不支持此方法'))\n  }\n\n  getRotate (_option?: Taro.MapContext.GetRotateOption): Promise<Taro.MapContext.GetRotateSuccessCallbackResult> {\n    return Promise.reject(new Error('暂不支持此方法'))\n  }\n\n  getSkew (_option?: Taro.MapContext.GetSkewOption): Promise<Taro.MapContext.GetSkewSuccessCallbackResult> {\n    return Promise.reject(new Error('暂不支持此方法'))\n  }\n\n  getScale (_option?: Taro.MapContext.GetScaleOption): Promise<Taro.MapContext.GetScaleSuccessCallbackResult> {\n    return Promise.reject(new Error('暂不支持此方法'))\n  }\n\n  setCenterOffset = temporarilyNotSupport('setCenterOffset')\n\n  removeCustomLayer = temporarilyNotSupport('removeCustomLayer')\n\n  addCustomLayer = temporarilyNotSupport('addCustomLayer')\n\n  addGroundOverlay = temporarilyNotSupport('addGroundOverlay')\n\n  addVisualLayer = temporarilyNotSupport('addVisualLayer')\n\n  removeVisualLayer = temporarilyNotSupport('removeVisualLayer')\n\n  addArc = temporarilyNotSupport('addArc')\n\n  removeArc = temporarilyNotSupport('removeArc')\n\n  setBoundary = temporarilyNotSupport('setBoundary')\n\n  updateGroundOverlay = temporarilyNotSupport('updateGroundOverlay')\n\n  removeGroundOverlay = temporarilyNotSupport('removeGroundOverlay')\n\n  toScreenLocation = temporarilyNotSupport('toScreenLocation')\n\n  fromScreenLocation = temporarilyNotSupport('fromScreenLocation')\n\n  openMapApp = temporarilyNotSupport('openMapApp')\n\n  addMarkers = temporarilyNotSupport('addMarkers')\n\n  removeMarkers = temporarilyNotSupport('removeMarkers')\n\n  initMarkerCluster = temporarilyNotSupport('initMarkerCluster')\n\n  on = temporarilyNotSupport('on')\n}\n"],"names":[],"mappings":"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"}