{"version":3,"file":"utils.js","sources":["../../../../src/api/apis/network/utils.ts"],"sourcesContent":["/**\n * HTTP Response Header 事件回调函数的参数\n * @typedef {Object} HeadersReceivedParam\n * @property {Object} header 开发者服务器返回的 HTTP Response Header\n */\n\n/**\n * HTTP Response Header 事件的回调函数\n * @callback HeadersReceivedCallback\n * @param {HeadersReceivedParam} res 参数\n */\n\n/**\n * 进度变化回调函数的参数\n * @typedef {Object} ProgressUpdateParam\n * @property {number} progress 进度百分比\n * @property {number} [totalBytesWritten] 已经下载的数据长度，单位 Bytes\n * @property {number} [totalBytesSent] 已经上传的数据长度，单位 Bytes\n * @property {number} [totalBytesExpectedToWrite] 预期需要下载的数据总长度，单位 Bytes\n * @property {number} [totalBytesExpectedToSend] 预期需要上传的数据总长度，单位 Bytes\n */\n\n/**\n * 进度变化事件的回调函数\n * @callback ProgressUpdateCallback\n * @param {ProgressUpdateParam} res 参数\n */\n\nexport const NETWORK_TIMEOUT = 60000\n\nexport const XHR_STATS = {\n  UNSENT: 0, // Client has been created. open() not called yet.\n  OPENED: 1, // open() has been called.\n  HEADERS_RECEIVED: 2, // send() has been called, and headers and status are available.\n  LOADING: 3, // Downloading; responseText holds partial data.\n  DONE: 4, // The operation is complete.\n}\n\n/**\n * 设置xhr的header\n * @param {XMLHttpRequest} xhr\n * @param {Object} header\n */\nexport const setHeader = (xhr, header) => {\n  let headerKey\n  for (headerKey in header) {\n    xhr.setRequestHeader(headerKey, header[headerKey])\n  }\n}\n\n/**\n * 将 blob url 转化为文件\n * @param {string} url 要转换的 blob url\n * @returns {Promise<File>}\n */\nexport const convertObjectUrlToBlob = (url) => {\n  return new Promise((resolve, reject) => {\n    const xhr = new XMLHttpRequest()\n    xhr.open('GET', url, true)\n    xhr.responseType = 'blob'\n    xhr.withCredentials = true\n    xhr.onload = function () {\n      if (this.status === 200) {\n        resolve(this.response)\n      } else {\n        /* eslint-disable prefer-promise-reject-errors */\n        reject({ status: this.status })\n      }\n    }\n    xhr.send()\n  })\n}\n"],"names":[],"mappings":"AAAA;;;;AAIG;AAEH;;;;AAIG;AAEH;;;;;;;;AAQG;AAEH;;;;AAIG;AAEI,MAAM,eAAe,GAAG,MAAK;AAEvB,MAAA,SAAS,GAAG;IACvB,MAAM,EAAE,CAAC;IACT,MAAM,EAAE,CAAC;IACT,gBAAgB,EAAE,CAAC;IACnB,OAAO,EAAE,CAAC;IACV,IAAI,EAAE,CAAC;EACR;AAED;;;;AAIG;MACU,SAAS,GAAG,CAAC,GAAG,EAAE,MAAM,KAAI;AACvC,IAAA,IAAI,SAAS,CAAA;AACb,IAAA,KAAK,SAAS,IAAI,MAAM,EAAE;QACxB,GAAG,CAAC,gBAAgB,CAAC,SAAS,EAAE,MAAM,CAAC,SAAS,CAAC,CAAC,CAAA;KACnD;AACH,EAAC;AAED;;;;AAIG;AACU,MAAA,sBAAsB,GAAG,CAAC,GAAG,KAAI;IAC5C,OAAO,IAAI,OAAO,CAAC,CAAC,OAAO,EAAE,MAAM,KAAI;AACrC,QAAA,MAAM,GAAG,GAAG,IAAI,cAAc,EAAE,CAAA;QAChC,GAAG,CAAC,IAAI,CAAC,KAAK,EAAE,GAAG,EAAE,IAAI,CAAC,CAAA;AAC1B,QAAA,GAAG,CAAC,YAAY,GAAG,MAAM,CAAA;AACzB,QAAA,GAAG,CAAC,eAAe,GAAG,IAAI,CAAA;QAC1B,GAAG,CAAC,MAAM,GAAG,YAAA;AACX,YAAA,IAAI,IAAI,CAAC,MAAM,KAAK,GAAG,EAAE;AACvB,gBAAA,OAAO,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAA;aACvB;iBAAM;;gBAEL,MAAM,CAAC,EAAE,MAAM,EAAE,IAAI,CAAC,MAAM,EAAE,CAAC,CAAA;aAChC;AACH,SAAC,CAAA;QACD,GAAG,CAAC,IAAI,EAAE,CAAA;AACZ,KAAC,CAAC,CAAA;AACJ;;;;"}