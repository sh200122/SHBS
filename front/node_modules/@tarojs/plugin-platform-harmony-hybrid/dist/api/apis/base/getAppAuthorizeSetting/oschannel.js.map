{"version":3,"file":"oschannel.js","sources":["../../../../../src/api/apis/base/getAppAuthorizeSetting/oschannel.ts"],"sourcesContent":["import Taro from '@tarojs/api'\n\n\nlet abilityAccessCtrl\n\ntry {\n  global.require\n  abilityAccessCtrl = requireNapi('abilityAccessCtrl')\n} catch (e) {} // eslint-disable-line no-empty\n\n// @ts-ignore\nexport const getAppAuthorizeSetting: typeof Taro.getAppAuthorizeSetting = () => {\n  const permissionsList = {\n    album: 'ohos.permission.WRITE_IMAGEVIDEO',\n    bluetooth: 'ohos.permission.USE_BLUETOOTH',\n    camera: 'ohos.permission.CAMERA',\n    location: 'ohos.permission.LOCATION',\n    locationAccuracy: 'ohos.permission.APPROXIMATELY_LOCATION',\n    microphone: 'ohos.permission.MICROPHONE',\n    notification: 'ohos.permission.NOTIFICATION_CONTROLLER',\n    phoneCalendar: 'ohos.permission.READ_CALENDAR',\n  }\n  const atManager = abilityAccessCtrl.createAtManager()\n  // @ts-ignore\n  const tokenID = bundleInfoForSelf.appInfo.accessTokenId\n  const grantStatus = (flag) => {\n    if (flag === -1) {\n      return 'denied'\n    } else if (flag === 0) {\n      return 'authorized'\n    }\n    return 'config error'\n  }\n  let albumAuthorized = 'not determined'\n  try {\n    albumAuthorized = atManager.checkAccessTokenSync(tokenID, permissionsList.album)\n    albumAuthorized = grantStatus(albumAuthorized)\n  } catch (e) {} // eslint-disable-line no-empty\n  let bluetoothAuthorized = 'not determined'\n  try {\n    bluetoothAuthorized = atManager.checkAccessTokenSync(tokenID, permissionsList.bluetooth)\n    bluetoothAuthorized = grantStatus(bluetoothAuthorized)\n  } catch (e) {} // eslint-disable-line no-empty\n  let cameraAuthorized = 'not determined'\n  try {\n    cameraAuthorized = atManager.checkAccessTokenSync(tokenID, permissionsList.camera)\n    cameraAuthorized = grantStatus(cameraAuthorized)\n  } catch (e) {} // eslint-disable-line no-empty\n  let locationAuthorized = 'not determined'\n  try {\n    locationAuthorized = atManager.checkAccessTokenSync(tokenID, permissionsList.location)\n    locationAuthorized = grantStatus(locationAuthorized)\n  } catch (e) {} // eslint-disable-line no-empty\n  let locationAccuracy = 'not determined'\n  try {\n    locationAccuracy =\n      atManager.checkAccessTokenSync(tokenID, permissionsList.locationAccuracy) === 0 ? 'full' : 'reduced'\n  } catch (e) {} // eslint-disable-line no-empty\n  let microphoneAuthorized = 'not determined'\n  try {\n    microphoneAuthorized = atManager.checkAccessTokenSync(tokenID, permissionsList.microphone)\n    microphoneAuthorized = grantStatus(microphoneAuthorized)\n  } catch (e) {} // eslint-disable-line no-empty\n  let notificationAuthorized = 'not determined'\n  try {\n    notificationAuthorized = atManager.checkAccessTokenSync(tokenID, permissionsList.notification)\n    notificationAuthorized = grantStatus(notificationAuthorized)\n  } catch (e) {} // eslint-disable-line no-empty\n  let phoneCalendarAuthorized = 'not determined'\n  try {\n    phoneCalendarAuthorized = atManager.checkAccessTokenSync(tokenID, permissionsList.phoneCalendar)\n    phoneCalendarAuthorized = grantStatus(phoneCalendarAuthorized)\n  } catch (e) {} // eslint-disable-line no-empty\n  const result = {\n    albumAuthorized,\n    bluetoothAuthorized,\n    cameraAuthorized,\n    locationAuthorized,\n    locationAccuracy,\n    microphoneAuthorized,\n    notificationAuthorized,\n    phoneCalendarAuthorized,\n  }\n  return result\n}\n"],"names":[],"mappings":"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"}