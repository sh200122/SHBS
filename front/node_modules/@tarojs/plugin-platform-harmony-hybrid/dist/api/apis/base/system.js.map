{"version":3,"file":"system.js","sources":["../../../../src/api/apis/base/system.ts"],"sourcesContent":["import Taro from '@tarojs/api'\n\nimport native from '../NativeApi'\nimport { shouldBeObject } from '../utils'\nimport { MethodHandler } from '../utils/handler'\nimport { getAppAuthorizeSetting } from './getAppAuthorizeSetting'\nimport { getSystemSetting } from './getSystemSetting'\n\n/**\n * 跳转系统蓝牙设置页\n *\n * @canNotUse openSystemBluetoothSetting\n */\nexport { openSystemBluetoothSetting } from '@tarojs/taro-h5'\n\n/**\n * 跳转系统授权管理页\n *\n * @canUse openAppAuthorizeSetting\n */\nexport const openAppAuthorizeSetting: typeof Taro.openAppAuthorizeSetting = (options) => {\n  const name = 'openAppAuthorizeSetting'\n  const isObject = shouldBeObject(options)\n  if (!isObject.flag) {\n    const res = { errMsg: `${name}:fail ${isObject.msg}` }\n    console.error(res.errMsg)\n    return Promise.reject(res)\n  }\n  const { success, fail, complete } = options as Exclude<typeof options, undefined>\n\n  const handle = new MethodHandler({ name, success, fail, complete })\n\n  return new Promise<TaroGeneral.CallbackResult>((resolve, reject) => {\n    // @ts-ignore\n    native.openAppAuthorizeSetting({\n      success: (res: any) => {\n        return handle.success(res, { resolve, reject })\n      },\n      fail: (err: any) => {\n        return handle.fail(err, { resolve, reject })\n      },\n    })\n  })\n}\n\n/**\n * 获取窗口信息\n *\n * @canUse getWindowInfo\n * @__return\n * [pixelRatio, screenWidth, screenHeight, windowWidth, windowHeight, statusBarHeight, safeArea[\\\n * bottom, height, left, right, top, width]]\n */\nexport const getWindowInfo: typeof Taro.getWindowInfo = () => {\n  // @ts-ignore\n  const info = native.getWindowInfo()\n  const windowInfo: Taro.getWindowInfo.Result = {\n    pixelRatio: info.pixelRatio,\n    screenWidth: info.screenWidth,\n    screenHeight: info.screenHeight,\n    windowWidth: info.screenWidth,\n    // @ts-ignore\n    windowHeight:\n      // @ts-ignore\n      info.screenHeight - (window?.currentNavigation?.style === 'default' ? window.navigationHeight || 0 : 0),\n    statusBarHeight: info.statusBarHeight,\n    safeArea: info.safeArea || {\n      /** 安全区域右下角纵坐标 */\n      bottom: info.screenHeight,\n      /** 安全区域的高度，单位逻辑像素, 窗口可用区域高度-状态栏高度 */\n      height: info.screenHeight - info.statusBarHeight,\n      /** 安全区域左上角横坐标 */\n      left: 0,\n      /** 安全区域右下角横坐标 */\n      right: info.screenWidth,\n      /** 安全区域左上角纵坐标, 状态栏高度 */\n      top: info.statusBarHeight,\n      /** 安全区域的宽度，单位逻辑像素 */\n      width: info.screenWidth,\n    },\n  }\n  return windowInfo\n}\n\n/**\n * 获取设备基础信息\n *\n * @canUse getDeviceInfo\n * @__return [benchmarkLevel, brand, model, system, platform]\n */\nexport const getDeviceInfo: typeof Taro.getDeviceInfo = () => {\n  // @ts-ignore\n  const info = native.getDeviceInfo()\n  // @ts-ignore\n  const deviceInfo: Taro.getDeviceInfo.Result = {\n    /** 设备性能等级（仅Android支持，HOS默认返回-1）。取值为：-2 或 0（该设备无法运行小游戏），-1（性能未知），>=1（设备性能值，该值越高，设备性能越好，目前最高不到50） */\n    benchmarkLevel: -1,\n    /** 设备品牌 */\n    brand: info.brand,\n    /** 设备型号 */\n    model: info.model,\n    /** 操作系统及版本 */\n    system: info.system,\n    /** 客户端平台 */\n    platform: info.platform,\n  }\n  return deviceInfo\n}\n\n/**\n * 获取APP基础信息\n *\n * @canUse getAppBaseInfo\n * @__return [SDKVersion, enableDebug, host[appId], language, version, theme[dark, light]]\n */\nexport const getAppBaseInfo: typeof Taro.getAppBaseInfo = () => {\n  // @ts-ignore\n  const info = native.getAppBaseInfo()\n  // @ts-ignore\n  const sdkApiVersion = native.getSystemInfoSync().ohosAPILevel.toString()\n  const appBaseInfo: Taro.getAppBaseInfo.Result = {\n    SDKVersion: sdkApiVersion,\n    enableDebug: info.enableDebug,\n    host: { appId: info.appId },\n    language: info.appLanguage,\n    version: info.appVersion,\n    theme: info.theme,\n  }\n  return appBaseInfo\n}\n\n\n/**\n * 获取系统信息Taro.getSystemInfo的同步版本\n *\n * @canUse getSystemInfoSync\n * @__return\n * [brand, model, pixelRatio, screenWidth, screenHeight, windowWidth, windowHeight, statusBarHeight,\\\n * language, version, system, platform, fontSizeSetting, SDKVersion, benchmarkLevel, albumAuthorized,\\\n * cameraAuthorized, locationAuthorized, microphoneAuthorized, notificationAuthorized, phoneCalendarAuthorized,\\\n * bluetoothEnabled, locationEnabled, wifiEnabled, safeArea[bottom, height, left, right, top, width],\\\n * locationReducedAccuracy, theme[dark, light], host[appId], enableDebug, deviceOrientation[portrait, landscape]]\n */\nexport const getSystemInfoSync: typeof Taro.getSystemInfoSync = () => {\n  // @ts-ignore\n  const info = native.getSystemInfoSync()\n  const windowInfo = getWindowInfo()\n  const systemSetting = getSystemSetting()\n  const appBaseInfo = getAppBaseInfo()\n  const appAuthorizeSetting = getAppAuthorizeSetting()\n  const systemInfoSync: Taro.getSystemInfoSync.Result = {\n    /** 设备品牌 */\n    brand: info.brand,\n    /** 设备型号 */\n    model: info.model,\n    /** 设备像素比 */\n    pixelRatio: windowInfo.pixelRatio,\n    /** 屏幕宽度，单位px */\n    screenWidth: windowInfo.screenWidth,\n    /** 屏幕高度，单位px */\n    screenHeight: windowInfo.screenHeight,\n    /** 可使用窗口宽度，单位px */\n    windowWidth: windowInfo.windowWidth,\n    /** 可使用窗口高度，单位px */\n    windowHeight: windowInfo.windowHeight,\n    /** 状态栏的高度，单位px */\n    statusBarHeight: windowInfo.statusBarHeight,\n    /** 微信设置的语言 */\n    language: info.language,\n    /** 微信版本号 */\n    version: info.version,\n    /** 操作系统及版本 */\n    system: info.system,\n    /** 客户端平台 */\n    platform: info.platform,\n    /** 用户字体大小（单位px）。以微信客户端「我-设置-通用-字体大小」中的设置为准 */\n    fontSizeSetting: info?.fontSizeSetting ?? 16,\n    /** 客户端基础库版本 */\n    SDKVersion: info.ohosAPILevel.toString(),\n    /** 设备性能等级（仅Android小游戏）。取值为：-2 或 0（该设备无法运行小游戏），-1（性能未知），>=1（设备性能值，该值越高，设备性能越好，目前最高不到50） */\n    benchmarkLevel: info.benchmarkLevel || -1,\n    /** 允许微信使用相册的开关（仅 iOS 有效） */\n    albumAuthorized: appAuthorizeSetting.albumAuthorized === 'authorized',\n    /** 允许微信使用摄像头的开关 */\n    cameraAuthorized: appAuthorizeSetting.cameraAuthorized === 'authorized',\n    /** 允许微信使用定位的开关 */\n    locationAuthorized: appAuthorizeSetting.locationAuthorized === 'authorized',\n    /** 允许微信使用麦克风的开关 */\n    microphoneAuthorized: appAuthorizeSetting.microphoneAuthorized === 'authorized',\n    /** 允许微信通知的开关 */\n    notificationAuthorized: appAuthorizeSetting.notificationAuthorized === 'authorized',\n    /** 允许微信使用日历的开关 */\n    phoneCalendarAuthorized: appAuthorizeSetting.phoneCalendarAuthorized === 'authorized',\n    /** 蓝牙的系统开关 */\n    bluetoothEnabled: systemSetting.bluetoothEnabled,\n    /** 地理位置的系统开关 */\n    locationEnabled: systemSetting.locationEnabled,\n    /** Wi-Fi 的系统开关 */\n    wifiEnabled: systemSetting.wifiEnabled,\n    /** 在竖屏正方向下的安全区域 */\n    safeArea: windowInfo.safeArea,\n    /** `true` 表示模糊定位，`false` 表示精确定位，仅 iOS 支持 */\n    locationReducedAccuracy: appAuthorizeSetting.locationReducedAccuracy,\n    /** 系统当前主题，取值为light或dark，全局配置\"darkmode\":true时才能获取，否则为 undefined （不支持小游戏） */\n    theme: appBaseInfo.theme,\n    /** 当前小程序运行的宿主环境 */\n    host: appBaseInfo.host,\n    /** 是否已打开调试。可通过右上角菜单或 [Taro.setEnableDebug](/docs/apis/base/debug/setEnableDebug) 打开调试。 */\n    enableDebug: appBaseInfo.enableDebug,\n    /** 设备方向 */\n    deviceOrientation: info.deviceOrientation,\n    /** 小程序当前运行环境 */\n    // environment: process.env.NODE_ENV\n  }\n  return systemInfoSync\n}\n\n/**\n * 异步获取系统信息\n *\n * @canUse getSystemInfoAsync\n * @__success\n * [brand, model, pixelRatio, screenWidth, screenHeight, windowWidth, windowHeight, statusBarHeight,\\\n * language, version, system, platform, fontSizeSetting, SDKVersion, benchmarkLevel, albumAuthorized,\\\n * cameraAuthorized, locationAuthorized, microphoneAuthorized, notificationAuthorized, phoneCalendarAuthorized,\\\n * bluetoothEnabled, locationEnabled, wifiEnabled, safeArea[bottom, height, left, right, top, width],\\\n * locationReducedAccuracy, theme[dark, light], host[appId], enableDebug, deviceOrientation[portrait, landscape]]\n */\nexport const getSystemInfoAsync: typeof Taro.getSystemInfoAsync = async (options = {}) => {\n  const { success, fail, complete } = options\n  const handle = new MethodHandler({ name: 'getSystemInfoAsync', success, fail, complete })\n  try {\n    const info = await getSystemInfoSync()\n    return handle.success(info)\n  } catch (error) {\n    return handle.fail({\n      errMsg: error,\n    })\n  }\n}\n\n/**\n * 获取系统信息\n *\n * @canUse getSystemInfo\n * @__success\n * [brand, model, pixelRatio, screenWidth, screenHeight, windowWidth, windowHeight, statusBarHeight,\\\n * language, version, system, platform, fontSizeSetting, SDKVersion, benchmarkLevel, albumAuthorized,\\\n * cameraAuthorized, locationAuthorized, microphoneAuthorized, notificationAuthorized, phoneCalendarAuthorized,\\\n * bluetoothEnabled, locationEnabled, wifiEnabled, safeArea[bottom, height, left, right, top, width],\\\n * locationReducedAccuracy, theme[dark, light], host[appId], enableDebug, deviceOrientation[portrait, landscape]]\n */\nexport const getSystemInfo: typeof Taro.getSystemInfo = async (options = {}) => {\n  const { success, fail, complete } = options\n  const handle = new MethodHandler({ name: 'getSystemInfo', success, fail, complete })\n  try {\n    const info = await getSystemInfoSync()\n    return handle.success(info)\n  } catch (error) {\n    return handle.fail({\n      errMsg: error,\n    })\n  }\n}\n"],"names":[],"mappings":"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"}