{"version":3,"file":"ClassInstanceManager.js","sources":["../../../../src/api/apis/interface/ClassInstanceManager.ts"],"sourcesContent":["import native from '../NativeApi'\n\nexport class ClassInstanceManager {\n  private static INSTANCE: ClassInstanceManager\n  private classIdMap: Map<string, number[]>\n  constructor () {\n    this.classIdMap = new Map<string, number[]>()\n  }\n\n  public static getInstance (): ClassInstanceManager {\n    if (!ClassInstanceManager.INSTANCE) {\n      ClassInstanceManager.INSTANCE = new ClassInstanceManager()\n    }\n    return ClassInstanceManager.INSTANCE\n  }\n\n  createInstance (className: string, option?: any) {\n    const objectId: number = native.createInstance({ ...option, className: className })\n    if (!this.classIdMap.has(className)) {\n      this.classIdMap.set(className, [])\n    }\n    (this.classIdMap.get(className) as Array<number>).push(objectId)\n    return objectId\n  }\n\n  getInstanceValue (className: string, name: string, objectId: number): any {\n    return native.callInstance({\n      type: 'get',\n      className: className,\n      property: name,\n      objectId: objectId\n    })\n  }\n\n  setInstanceValue (option: any, className: string, name: string, objectId: number): any {\n    return native.callInstance({\n      option: option,\n      className: className,\n      type: 'set',\n      property: name,\n      objectId: objectId\n    })\n  }\n\n  setInstanceFunction (option: any, className: string, name: string, objectId: number): any {\n    return native.callInstance({\n      option: option,\n      className: className,\n      type: 'function',\n      property: name,\n      objectId: objectId\n    })\n  }\n\n  setInstanceFunctionAsync (option: any, className: string, name: string, objectId: number): any {\n    return native.callInstanceAsync({\n      option: option,\n      className: className,\n      type: 'function',\n      property: name,\n      objectId: objectId\n    })\n  }\n\n  destroyInstance (className: string, objectId: number) {\n    const instances = this.classIdMap.get(className)\n    if (instances) {\n      const index = instances.indexOf(objectId)\n      if (index !== -1) {\n        instances.splice(index, 1)\n      }\n      native.syncAndReleaseInstance({ className: className, option: this.classIdMap.get(className) })\n    }\n  }\n}\n"],"names":[],"mappings":"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"}