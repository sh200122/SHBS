{"version":3,"file":"style-event.js","sources":["../../../../../src/api/apis/ui/navigation-bar/style-event.ts"],"sourcesContent":["import Taro from '@tarojs/api'\n\nimport native from '../../NativeApi'\n\n/**\n * 导航条与Web层叠布局，导航条可见情况下Web页面顶部空出一定高度的留白\n */\nexport function loadNavigationStyle () {\n  if (window === undefined) {\n    return\n  }\n  // @ts-ignore\n  const naviHeight = window.navigationHeight ? window.navigationHeight : 0\n  const css = `\n.taro_router .taro_page.taro_navigation_page {\n  padding-top: ${naviHeight}px;\n}\n\n.taro-tabbar__container .taro_page.taro_navigation_page {\n  max-height: calc(100vh - ${naviHeight}px);\n}\n\n.taro-tabbar__container .taro_page.taro_tabbar_page.taro_navigation_page {\n  max-height: calc(100vh - 50px - ${naviHeight}px);\n}`\n  const style = document.createElement('style')\n  style.innerHTML = css\n  document.getElementsByTagName('head')[0].appendChild(style)\n}\n\n/**\n * 监听导航栏设置、进入/退出全屏事件，更改导航栏样式以及显示/隐藏胶囊按钮\n */\nexport function registerNavigationStyleHandler () {\n  if (window !== undefined) {\n    // @ts-ignore\n    window.currentNavigation = {}\n  }\n\n  Taro.eventCenter.on('__taroSetNavigationStyle', (style, textStyle, backgroundColor) => {\n    if (window !== undefined) {\n      native.setNavigationStyle({ style: style, textStyle: textStyle, backgroundColor: backgroundColor })\n      // @ts-ignore\n      Object.assign(window.currentNavigation, {\n        style,\n        textStyle,\n        backgroundColor,\n      })\n      // @ts-ignore\n      const { originCapsuleVisible } = window\n      if (originCapsuleVisible !== undefined) {\n        native.setCapsuleState({ visible: originCapsuleVisible })\n      }\n    }\n  })\n\n  Taro.eventCenter.on('__taroEnterFullScreen', () => {\n    native.setNavigationStyle({ style: 'custom', textStyle: 'black', backgroundColor: '#000000' })\n    // @ts-ignore\n    if (window.originCapsuleVisible === undefined) {\n      // @ts-ignore\n      window.originCapsuleVisible = native.getCapsuleState().visible\n    }\n    native.setCapsuleState({ visible: false })\n  })\n\n  Taro.eventCenter.on('__taroExitFullScreen', () => {\n    // @ts-ignore\n    const { style, textStyle, backgroundColor } = window.currentNavigation\n    native.setNavigationStyle({ style: style, textStyle: textStyle, backgroundColor: backgroundColor })\n    // @ts-ignore\n    const { originCapsuleVisible } = window\n    if (originCapsuleVisible !== undefined) {\n      native.setCapsuleState({ visible: originCapsuleVisible })\n    }\n  })\n}\n"],"names":[],"mappings":";;;AAIA;;AAEG;SACa,mBAAmB,GAAA;AACjC,IAAA,IAAI,MAAM,KAAK,SAAS,EAAE;QACxB,OAAM;KACP;;AAED,IAAA,MAAM,UAAU,GAAG,MAAM,CAAC,gBAAgB,GAAG,MAAM,CAAC,gBAAgB,GAAG,CAAC,CAAA;AACxE,IAAA,MAAM,GAAG,GAAG,CAAA;;iBAEG,UAAU,CAAA;;;;6BAIE,UAAU,CAAA;;;;oCAIH,UAAU,CAAA;EAC5C,CAAA;IACA,MAAM,KAAK,GAAG,QAAQ,CAAC,aAAa,CAAC,OAAO,CAAC,CAAA;AAC7C,IAAA,KAAK,CAAC,SAAS,GAAG,GAAG,CAAA;AACrB,IAAA,QAAQ,CAAC,oBAAoB,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,WAAW,CAAC,KAAK,CAAC,CAAA;AAC7D,CAAC;AAED;;AAEG;SACa,8BAA8B,GAAA;AAC5C,IAAA,IAAI,MAAM,KAAK,SAAS,EAAE;;AAExB,QAAA,MAAM,CAAC,iBAAiB,GAAG,EAAE,CAAA;KAC9B;AAED,IAAA,IAAI,CAAC,WAAW,CAAC,EAAE,CAAC,0BAA0B,EAAE,CAAC,KAAK,EAAE,SAAS,EAAE,eAAe,KAAI;AACpF,QAAA,IAAI,MAAM,KAAK,SAAS,EAAE;AACxB,YAAA,MAAM,CAAC,kBAAkB,CAAC,EAAE,KAAK,EAAE,KAAK,EAAE,SAAS,EAAE,SAAS,EAAE,eAAe,EAAE,eAAe,EAAE,CAAC,CAAA;;AAEnG,YAAA,MAAM,CAAC,MAAM,CAAC,MAAM,CAAC,iBAAiB,EAAE;gBACtC,KAAK;gBACL,SAAS;gBACT,eAAe;AAChB,aAAA,CAAC,CAAA;;AAEF,YAAA,MAAM,EAAE,oBAAoB,EAAE,GAAG,MAAM,CAAA;AACvC,YAAA,IAAI,oBAAoB,KAAK,SAAS,EAAE;gBACtC,MAAM,CAAC,eAAe,CAAC,EAAE,OAAO,EAAE,oBAAoB,EAAE,CAAC,CAAA;aAC1D;SACF;AACH,KAAC,CAAC,CAAA;IAEF,IAAI,CAAC,WAAW,CAAC,EAAE,CAAC,uBAAuB,EAAE,MAAK;AAChD,QAAA,MAAM,CAAC,kBAAkB,CAAC,EAAE,KAAK,EAAE,QAAQ,EAAE,SAAS,EAAE,OAAO,EAAE,eAAe,EAAE,SAAS,EAAE,CAAC,CAAA;;AAE9F,QAAA,IAAI,MAAM,CAAC,oBAAoB,KAAK,SAAS,EAAE;;YAE7C,MAAM,CAAC,oBAAoB,GAAG,MAAM,CAAC,eAAe,EAAE,CAAC,OAAO,CAAA;SAC/D;QACD,MAAM,CAAC,eAAe,CAAC,EAAE,OAAO,EAAE,KAAK,EAAE,CAAC,CAAA;AAC5C,KAAC,CAAC,CAAA;IAEF,IAAI,CAAC,WAAW,CAAC,EAAE,CAAC,sBAAsB,EAAE,MAAK;;QAE/C,MAAM,EAAE,KAAK,EAAE,SAAS,EAAE,eAAe,EAAE,GAAG,MAAM,CAAC,iBAAiB,CAAA;AACtE,QAAA,MAAM,CAAC,kBAAkB,CAAC,EAAE,KAAK,EAAE,KAAK,EAAE,SAAS,EAAE,SAAS,EAAE,eAAe,EAAE,eAAe,EAAE,CAAC,CAAA;;AAEnG,QAAA,MAAM,EAAE,oBAAoB,EAAE,GAAG,MAAM,CAAA;AACvC,QAAA,IAAI,oBAAoB,KAAK,SAAS,EAAE;YACtC,MAAM,CAAC,eAAe,CAAC,EAAE,OAAO,EAAE,oBAAoB,EAAE,CAAC,CAAA;SAC1D;AACH,KAAC,CAAC,CAAA;AACJ;;;;"}