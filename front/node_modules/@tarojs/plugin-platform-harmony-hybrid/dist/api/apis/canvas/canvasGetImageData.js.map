{"version":3,"file":"canvasGetImageData.js","sources":["../../../../src/api/apis/canvas/canvasGetImageData.ts"],"sourcesContent":["import Taro from '@tarojs/api'\n\nimport { findDOM } from '../utils'\nimport { MethodHandler } from '../utils/handler'\n\n/**\n * 获取 canvas 区域隐含的像素数据。\n *\n * @canUse canvasGetImageData\n * @__object [canvasId, x, y, height, width]\n * @__success [data, height, width]\n */\nexport const canvasGetImageData: typeof Taro.canvasGetImageData = (\n  { canvasId, success, fail, complete, x, y, width, height },\n  inst\n) => {\n  const handle = new MethodHandler({ name: 'canvasGetImageData', success, fail, complete })\n  const el = findDOM(inst) as HTMLElement\n  const canvas = el?.querySelector(`canvas[canvas-id=\"${canvasId}\"]`) as HTMLCanvasElement\n\n  try {\n    const ctx = canvas?.getContext('2d')\n    // TODO ImageData => Uint8ClampedArray\n    const data = ctx?.getImageData(x, y, width, height) as unknown as Uint8ClampedArray\n    return handle.success({\n      width,\n      height,\n      data,\n    })\n  } catch (e) {\n    return handle.fail({\n      errMsg: e.message,\n    })\n  }\n}\n"],"names":[],"mappings":";;;AAKA;;;;;;AAMG;AACU,MAAA,kBAAkB,GAAmC,CAChE,EAAE,QAAQ,EAAE,OAAO,EAAE,IAAI,EAAE,QAAQ,EAAE,CAAC,EAAE,CAAC,EAAE,KAAK,EAAE,MAAM,EAAE,EAC1D,IAAI,KACF;AACF,IAAA,MAAM,MAAM,GAAG,IAAI,aAAa,CAAC,EAAE,IAAI,EAAE,oBAAoB,EAAE,OAAO,EAAE,IAAI,EAAE,QAAQ,EAAE,CAAC,CAAA;AACzF,IAAA,MAAM,EAAE,GAAG,OAAO,CAAC,IAAI,CAAgB,CAAA;AACvC,IAAA,MAAM,MAAM,GAAG,EAAE,KAAA,IAAA,IAAF,EAAE,KAAF,KAAA,CAAA,GAAA,KAAA,CAAA,GAAA,EAAE,CAAE,aAAa,CAAC,CAAA,kBAAA,EAAqB,QAAQ,CAAA,EAAA,CAAI,CAAsB,CAAA;AAExF,IAAA,IAAI;AACF,QAAA,MAAM,GAAG,GAAG,MAAM,KAAA,IAAA,IAAN,MAAM,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAN,MAAM,CAAE,UAAU,CAAC,IAAI,CAAC,CAAA;;AAEpC,QAAA,MAAM,IAAI,GAAG,GAAG,aAAH,GAAG,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAH,GAAG,CAAE,YAAY,CAAC,CAAC,EAAE,CAAC,EAAE,KAAK,EAAE,MAAM,CAAiC,CAAA;QACnF,OAAO,MAAM,CAAC,OAAO,CAAC;YACpB,KAAK;YACL,MAAM;YACN,IAAI;AACL,SAAA,CAAC,CAAA;KACH;IAAC,OAAO,CAAC,EAAE;QACV,OAAO,MAAM,CAAC,IAAI,CAAC;YACjB,MAAM,EAAE,CAAC,CAAC,OAAO;AAClB,SAAA,CAAC,CAAA;KACH;AACH;;;;"}